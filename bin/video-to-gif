#!/bin/bash

# Based on http://superuser.com/questions/556029/how-do-i-convert-a-video-to-gif-using-ffmpeg-with-reasonable-quality

set -e

source="$1"
source_palette="/tmp/$source-palette.png"
common_filter="fps=10,scale=-1:-1"

ffmpeg -i "$source" -vf "$common_filter,palettegen" -y "$source_palette"
ffmpeg -i "$source" -i "$source_palette" -filter_complex "$common_filter,paletteuse" "$source.gif"
