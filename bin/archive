#!/bin/bash

# Compresses a directory and moves it to where I archive my files

set -e

SOURCE="$1"
if [ ! -e "$SOURCE" ]; then
  echo "Source not found: $SOURCE"
  exit 1
fi

DESTINATION_ROOT="$HOME/Google Drive/Archived ðŸ“¦"
if [ ! -d "$DESTINATION_ROOT" ]; then
  echo "Destination root not found: $DESTINATION_ROOT"
  exit 1
fi

DESTINATION_DIR="$DESTINATION_ROOT/$(date +%Y)"
mkdir -p "$DESTINATION_DIR"

# Use pack to compress and capture the filename
PACKED_SOURCE=$(pack "$SOURCE")
ARCHIVED_SOURCE="$DESTINATION_DIR/$PACKED_SOURCE"

# Move the zip file to the destination directory
mv "$PACKED_SOURCE" "$ARCHIVED_SOURCE"

trash "$SOURCE"

echo "Archived to $ARCHIVED_SOURCE"
